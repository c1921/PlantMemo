<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>植记 PlantMemo</title>
	<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css">
	<link rel="stylesheet" href="style.css">
</head>

<body>

	<div id="app" class="section">

		<header class="mb-5">
			<p class="title is-1">PlantMemo</p>
			<div class="is-flex is-justify-content-space-between">
				<div>
					<button @click="newCard" class="button is-success">新建植物</button>
				</div>
				<div>
					<button @click="exportData" class="button">导出数据</button>
					<button @click="triggerFileInput" class="button">导入数据</button>
					<input type="file" id="fileInput" @change="importData" style="display: none;" />
				</div>
			</div>
		</header>

		<div class="fixed-grid has-4-cols-desktop has-2-cols-tablet has-1-cols-mobile">
			<div class="grid">

				<div v-for="(card, index) in cards" :key="index">
					<template v-if="!card.editing">

						<div class="card">
							<div class="card-image">
								<figure class="image is-3by1">
									<img :src="card.image" v-if="card.image" alt="Card Image">
								</figure>
							</div>
							<div class="card-content">
								<div class="media">
									<div class="media-content py-1">
										<p class="title is-4">{{ card.title }}</p>
										<p class="subtitle is-4 is-italic">{{ card.subtitle }}</p>
									</div>
								</div>
								<div class="content">
									{{ card.description }}
									<p>光照：{{ card.sunlight }}</p>
									<div class="field has-addons">
										<progress class="progress is-success is-large"
											v-bind:value="calculateProgress(card)" max="100"></progress>
										<button @click="waterCard(card)" class="button">浇水</button>
									</div>

								</div>
							</div>
							<footer class="card-footer">
								<button @click="editCard(card)" class="card-footer-item">编辑</button>

							</footer>
						</div>
					</template>

					<template v-else>
						<div class="box">
							<div id="file-name" class="file has-name">
								<label class="file-label">
									<input class="file-input" type="file" @change="handleFileUpload($event, card)"
										name="resume" />
									<span class="file-cta">
										<span class="file-icon">
											<i class="fas fa-upload"></i>
										</span>
										<span class="file-label"> 选择图片… </span>
									</span>
									<span class="file-name">{{ selectedFileName || '未加载图片' }}</span> </label>
							</div>
							<div class="field">
								<label class="label">植物名称</label>
								<div class="control">
									<input class="input" type="text" v-model="card.title" placeholder="输入植物名称">
								</div>
							</div>
							<div class="field">
								<label class="label">植物学名</label>
								<div class="control">
									<input class="input" type="text" v-model="card.subtitle" placeholder="输入拉丁学名">
								</div>
							</div>
							<div class="field">
								<label class="label">简介</label>
								<div class="control">
									<textarea class="textarea" v-model="card.description"
										placeholder="输入植物简介"></textarea>
								</div>
							</div>

							<div class="field">
								<label class="label">光照</label>
								<div class="control">
									<div class="select">
										<select v-model="card.sunlight">
											<option value="全日照">全日照</option>
											<option value="半日照">半日照</option>
										</select>
									</div>
								</div>
							</div>
							<div class="field">
								<label class="label">上次浇水日期</label>
								<div class="control">
									<input class="input" type="date" v-model="card.lastWatered"
										placeholder="Last Watered">
								</div>
							</div>
							<div class="field">
								<label class="label">浇水间隔</label>
								<div class="control">
									<input class="input" type="number" v-model="card.wateringInterval"
										placeholder="浇水间隔（天）">
								</div>
							</div>
							<button @click="saveCard(card)" class="button is-light">保存</button>
							<button @click="cancelEdit(card)" class="button">取消</button>
							<button @click="deleteCard(card)" class="button is-danger">删除</button>
						</div>

					</template>
				</div>
			</div>
		</div>
	</div>
	<script src="app.js"></script>
</body>

</html>